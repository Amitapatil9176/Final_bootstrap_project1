var appHandle="kraken",isEnabled;function initApp(){var e=document.querySelectorAll("form[action*='/account/login']");isEnabled=!1,document.documentElement.classList.contains("snap-login-enabled")||0!==e.length&&(window.location.href.includes("account/invalid_token")?e.forEach((e,s)=>{e=e.querySelector('input[name="customer[password]"');"none"===e.style.display&&(e.style.display="block")}):e.forEach((e,s)=>{togglePassword(e,"block")}))}function isValidEmail(e){e=decodeURIComponent(e);return!1!==/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+)/gi.test(e)}function createMessageWrapper(e,s){var t=document.getElementById("messageWrapper")||null,t=(t&&t.remove(),document.createElement("div"));t.id="messageWrapper",e.prepend(t),t.classList.add("form-message","note"),t.innerHTML=s}function togglePassword(e,s){var t=e.querySelector('input[name="customer[password]"'),a=e.querySelector(".is-hidden"),r=e.querySelectorAll("label")[1]||null,e=e.querySelector(".password-wrapper");let o;(o=t?t.parentElement.classList.contains("field")||t.parentElement.classList.contains("input"):o)?t.parentElement.style.display=s:r&&(r.style.display=s),e&&(e.style.display=s),t&&(t.style.display=s,isEnabled)&&"block"===s&&t.focus(),a&&("block"===s&&a.classList.remove("is-hidden"),"none"===s)&&a.classList.add("is-hidden")}function releaseTheKraken(){document.querySelectorAll("form[action*='/account/login']").forEach((r,e)=>{if(r){var s=r.querySelector('input[name="customer[email]"');const o=r.querySelector("input[type=submit]")||r.querySelector("button[type=submit]")||r.querySelector("button");s&&(s.attributes.required="required"),togglePassword(r,"none"),o.onclick=e=>{-1!=window.location.href.indexOf("login")&&e.preventDefault();var e=new FormData(r),s=encodeURIComponent(e.get("customer[email]")),e=e.get("customer[password]");if(isValidEmail(s)){const t=o.value||o.innerHTML,a=(o.classList.add("loading"),o.disabled=!0,o.value="Please Wait",o.innerHTML="Please Wait",new XMLHttpRequest);a.onreadystatechange=function(){var e,s;4===a.readyState&&(200===a.status?(e=JSON.parse(a.responseText),createMessageWrapper(r,e.message),s=document.getElementById("messageWrapper"),o.disabled=!1,o.classList.remove("loading"),"enabled"===e.status||"other"===e.status?(s.classList.remove("form-errors","errors"),s.classList.add("form-success","form-message--success"),togglePassword(r,"block"),o.value="Continue",o.innerHTML="Continue"):("disabled"===e.status?(s.classList.remove("form-errors","errors"),s.classList.add("form-success","form-message--success")):(s.classList.add("form-errors","errors"),s.classList.remove("form-success","form-message--success"),togglePassword(r,"none")),o.value=t,o.innerHTML=t)):(o.disabled=!1,o.classList.remove("loading"),o.value=t))},a.open("GET",`/apps/${appHandle}/customer/`+s),a.send()}else r.reportValidity();e&&r.submit()}}})}initApp();